% ------------------------------------------------------------------------
% LaTeX - Preambel  ******************************************************
% ------------------------------------------------------------------------
% von: Matthias Pospiech
% ========================================================================

% Strukturierung dieser Praeambel:
%    1.  Pakete die vor anderen geladen werden müssen
%        (calc, babel, xcolor, graphicx, amsmath, pst-pdf, ragged2e, ...)
%    2.  Schriften
%    3.  Mathematik (mathtools, fixmath, onlyamsmath, braket,
%        cancel, empheq, exscale, icomma, ...)
%    4.  Tabellen (booktabs, multirow, dcolumn, tabularx, ltxtable, supertabular)
%    5.  Text
%        5.1 Auszeichnungen (ulem, soul, url)
%        5.2 Fussnoten (footmisc)
%        5.3 Verweise (varioref)
%        5.4 Listen (enumitem, paralist, declist)
%    6.  Zitieren (csquotes, jurabib, natbib)
%    7.  PDF (microtype, hyperref, backref, hypcap, pdfpages
%    8.  Graphiken (float, flafter, placeins, subfig, wrapfig,
%        floatflt, picins, psfrag, sidecap, pict2e, curve2e)
%    9.  Sonstiges (makeidx, isodate, numprint, nomencl, acronym)
%    10. Verbatim (upquote, verbatim, fancyvrb, listings, examplep)
%    11. Wissenschaft (units)
%    12. Fancy Stuff
%    13. Layout
%       13.1.  Diverse Pakete und Einstellungen (multicol, ellipsis)
%       13.2.  Zeilenabstand (setspace)
%       13.3.  Seitenlayout (typearea, geometry)
%       13.4.  Farben
%       13.5.  Aussehen der URLS
%       13.6.  Kopf und Fusszeilen (scrpage2)
%       13.7.  Fussnoten
%       13.8.  Schriften (Sections )
%       13.9.  UeberSchriften (Chapter und Sections) (titlesec, indentfirst)
%       13.10. Captions (Schrift, Aussehen)
%              (caption, subfig, capt-of, mcaption, tocloft, multitoc, minitoc)
%    14.  Auszufuehrende Befehle


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Einige Pakete muessen unbedingt vor allen anderen geladen werden
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


%% PW: Macht in Zukunft "room for a new \write"
%% braucht l3kernel
%\usepackage{morewrites}

%% PW: Tip von H Oberdiek: Volle Ausgabe der Fehlermeldungen
\errorcontextlines=\maxdimen


%% PW: Tip von H. Oberdiek:
%% Zählerwert und \thepage auf jeder Seite protokollieren lassen
\usepackage{atbegshi}
\AtBeginShipout{\typeout{* Page \the\value{page} (\thepage)}}

%
%
%%% Doc: www.cs.brown.edu/system/software/latex/doc/calc.pdf
% Calculation with LaTeX
\usepackage{calc}


%% PW: Befehle mit mehr als einem optionalen Argument. 
\usepackage{xargs}

%%PW chapterbib. Macht nicht das, was es soll (Ein Literaturverzeichnis für jedes \include). Braucht wohl auch mehrere separate BibTeX-Durchläufe für jede include-Datei einmal :-(
%% Chapterbib muss laut Doku vor Babel. Doku ist im chapterbib.sty-File am Ende!!
%\usepackage{chapterbib}
%PW bibunits. Braucht extra-Durchläufe von BibTeX. Unkomfortabel.
%\usepackage{bibunits}

% Hat wohl das was ich brauche. Ersetzt Befehl \bibliography durch \btPrintCited. Mit backref-Option bei hyperref muss es nach hyperref geladen werden. Dort steht der Befehl nochmals!
%\usepackage[%
%verbose%
%]{bibtopic}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/required/babel/babel.pdf
% Languagesetting
\ifthenelse{\boolean{iesenglishs}}%
{\usepackage[english]{babel}}%
{\usepackage[ngerman]{babel}}


%% PW: Soll bei zu wenigen TeX \writes helfen. Aber einfach einbinden hilft nicht :-( Braucht selber auch ein write (auf den dann alles geleitet wird).
% \usepackage{rvwrite}



% default
%%\usepackage[
%%%	french,
%%	english,
%%%	german,
%%	ngerman,  %%%% PW: irgendwo gelesen: letzte Option gilt als Standardsprache
%%]{babel}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/xcolor/xcolor.pdf
% Farben
% Incompatible: Do not load when using pstricks !
\usepackage[
	table, % Load for using rowcolors command in tables
	cmyk, % CMYK Farbraum
]{xcolor}


%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/required/graphics/grfguide.pdf
% Bilder
\usepackage[%
	%final,
	%draft, % do not include images (faster)
	%pdftex, %für asymptote  %% sorgt für PDF mode expected, but DVI mode detected!!!!! Keinen Treiber auswählen bei graphicx, sonst geht pstool nicht mehr!!!!!
]{graphicx}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/oberdiek/epstopdf.pdf
%% If an eps image is detected, epstopdf is automatically called to convert it to pdf format.
%% Requires: graphicx loaded


%% PW: Bisschen vorgezogen
%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/marginnote/marginnote.pdf
% Summary description: marginnote allows margin note, where \marginpar fails
\usepackage{marginnote}

\usepackage{ifplatform}

%%%PW: Tip von H. Oberdiek
\usepackage{ltxcmds}[2010/04/26]
\makeatletter
\let\HashChar\ltx@hashchar
\makeatother

%%%PW: Tip von H. Oberdiek
%\begingroup
  %\catcode`\#=12 %
%\edef\x{\endgroup
  %\noexpand\newcommand*{\noexpand\HashChar}{#}%
%}\x

\ifpdf  %% PW: Bringt leider nix: PDF mode expected, but DVI mode detected hat nix damit zu tun
\usepackage{epstopdf}

\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{%
  ps2pdf %
  -dEPSCrop %
	-dAutoRotatePages\HashChar /None %
  -dPDFSETTINGS\HashChar /prepress %
  -dCompatibilityLevel\HashChar 1.3 %
	-dEmbedAllFonts\HashChar true %
	-dSubsetFonts\HashChar true
  #1 \OutputFile
}

%%%%%%%%%%%%%%%%% Varianten, die alle nicht funktionieren... %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf "-dEPSCrop" "-dAutoRotatePages\HashChar/None" "-dPDFSETTINGS\HashChar/prepress" "-dCompatibilityLevel\HashChar1.2" #1 \noexpand\OutputFile} % braucht oben definiertes Makro \HashChar

%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf -dEPSCrop -dAutoRotatePages\ltx@hashchar/None -dPDFSETTINGS\ltx@hashchar/prepress -dCompatibilityLevel\ltx@hashchar 1.3 #1 \OutputFile} %\ltx@hashchar ist aus ltxcmds (Oberdiek)

%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf "-dEPSCrop" "-dAutoRotatePages\ltx@hashchar/None" "-dPDFSETTINGS\ltx@hashchar/prepress" "-dCompatibilityLevel\ltx@hashchar1.3" #1 \OutputFile} %\ltx@hashchar ist aus ltxcmds (Oberdiek)

%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf -dPDFSETTINGS\string##/prepress -dCompatibilityLevel\string##1.3 #1 \OutputFile} 
%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf -dPDFSETTINGS\string#/prepress -dCompatibilityLevel\string#1.3 #1 \OutputFile} 
%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf -dPDFSETTINGS##/prepress -dCompatibilityLevel##1.3 #1 \OutputFile} % geht nicht

%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf "-dEPSCrop" "-dAutoRotatePages\string#/None" "-dPDFSETTINGS\string#/prepress" "-dCompatibilityLevel\string#1.3" #1 \noexpand\OutputFile}

%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{ps2pdf "-dEPSCrop" "-dAutoRotatePages=/None" "-dPDFSETTINGS=/prepress" "-dCompatibilityLevel=1.3" #1 \OutputFile}

%%% Problematisch wegen Mehrfachbedeutung der Raute: Latex: Makro, epstopdf: Platzhalter für Dateinamen, Unter DOS bei Batchfiles als Argument statt '='.
%\epstopdfsetup{program@epstopdf=epstopdf}
%\epstopdfDeclareGraphicsRule{.eps}{pdf}{.pdf}{epstopdf --gsopt=-dCompatibilityLevel=1.3 #1 \OutputFile}%  %Nur unter MikTeX mit Windows, nicht unter TeXlive
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/required/amslatex/math/amsldoc.pdf
% Amsmath - Mathematik Basispaket
%
% fuer pst-pdf displaymath Modus vor pst-pdf benoetigt.
\usepackage[
   centertags, % (default) center tags vertically
   %tbtags,    % 'Top-or-bottom tags': For a split equation, place equation numbers level
               % with the last (resp. first) line, if numbers are on the right (resp. left).
   sumlimits,  %(default) Place the subscripts and superscripts of summation
               % symbols above and below
   %nosumlimits, % Always place the subscripts and superscripts of summation-type
               % symbols to the side, even in displayed equations.
   intlimits,  % Like sumlimits, but for integral symbols.
   %nointlimits, % (default) Opposite of intlimits.
   namelimits, % (default) Like sumlimits, but for certain 'operator names' such as
               % det, inf, lim, max, min, that traditionally have subscripts placed underneath
               % when they occur in a displayed equation.
   %nonamelimits, % Opposite of namelimits.
   %leqno,     % Place equation numbers on the left.
   %reqno,     % Place equation numbers on the right.
   fleqn,     % Position equations at a fixed indent from the left margin
   			  % rather than centered in the text column.
]{amsmath} %
% eqnarray nicht zusammen mit amsmath benutzen, siehe l2tabu.pdf für
% Hintergruende.


%%PW: Kommentare einfügen
%% Braucht ein \write. Vielleicht eins zuviel, Asymptote braucht auch welche, es gibt ing. nur 16.
%\usepackage{comment}
%\includecomment{showcomment}
%\excludecomment{hidecomment}


%% Doc: ftp://tug.ctan.org/pub/tex-archive/graphics/pstricks/README
%% Im Beispiel auf der Homepage vor auto-pst-pdf
% load before graphicx
 %\usepackage{pstricks}  %%Funktioniert nicht zusammen mit pstool, weil pstool nur Unterstützung für psfrag bietet.
 %\usepackage{pst-plot, pst-node, pst-coil, pst-eps}


%%% Doc: http://www.ctan.org/tex-archive/macros/latex/contrib/pst-pdf/pst-pdf-DE.pdf
% Used to automatically integrate eps graphics in an pdf document using pdflatex.
% Requires ps4pdf macro !!!
% Download macro from http://www.ctan.org/tex-archive/macros/latex/contrib/pst-pdf/scripts/

%\usepackage[%
%   %active,       % Aktiviert den Extraktionsmodus (DVI-Ausgabe). Die explizite Angabe ist
%                  % normalerweise unnötig (Standard im LATEX-Modus).
%   %inactive,     % Das Paket wird deaktiviert, Zuätzlich werden die Pakete pstricks und
%                  % graphicx geladen
%   nopstricks,    % Das Paket pstricks wird nicht geladen.
%   %draft,        % Im pdfLATEX-Modus werden aus der Containerdatei eingefügte Grafiken nur
%                  % als Rahmen dargestellt.
%   %final,        % Im pdfLATEX-Modus werden aus der Containerdatei eingefügte Grafiken
%                  % vollständig dargestellt (Standard).
%   %tightpage,    % Die Abmessung Grafiken in der Containerdatei entsprechen denen der
%                  % zugehörigen TEX-Boxen (Standard).
%   %notightpage,  % die Grafiken in der Containerdatei nehmen
%                  % mindestens die Größe des gesamten Blattes einnehmen.
%   %displaymath,  % Es werden zusätzlich die mathematischen Umgebungen displaymath,
%                  % eqnarray und $$ extrahiert und im pdf-Modus als Grafik eingefügt.
%]{pst-pdf}

%% Geht zusammen mit pstricks, aber nicht zusammen mit pstool. Also entweder auto-pst-pdf oder pstool.
%\usepackage[
%	on,
%%	crop=off,
%	crop=on,
%%	cleanup={log,aux,dvi,ps,pdf},
%]{auto-pst-pdf}
%%
% Notwendiger Bugfix für natbib Paket bei Benutzung von pst-pdf (Version <= v1.1o)
\IfPackageLoaded{pst-pdf}{
   \providecommand\makeindex{}
   \providecommand\makeglossary{}
}{}


% This package implements a workaround for the LaTeX bug that marginpars
% sometimes appear on the wrong margin.
%% PW: Hilft auch nicht
%\usepackage{mparhack}
% in some case this causes an error in the index together with package pdfpages
% the reason is unkown. Therefore I recommend to use the margins of marginnote


%% Doc: (inside relsize.sty )
%% ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/relsize.sty
%  Set the font size relative to the current font size
\usepackage{relsize}

%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/ms/ragged2e.pdf
% Besserer Flatternsatz (Linksbuendig, statt Blocksatz)
\usepackage{ragged2e}

%%PW: Markus Kohms gridset zum registerhaltigen Satz. (Zeilen der Vorderseite matchen die Zeilen der Rückseite wenn man es gegen das Licht hält)
%% Man muss händisch an die Absätze \vskipnextgrid setzen und für jedes \vskipnextgrid braucht man (mehr od. weniger) einen extra-Durchlauf von pdfLaTeX :-(
%\usepackage{gridset}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Fonts Fonts Fonts
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\usepackage[T1]{fontenc} % T1 Schrift Encoding 
%% PW: Im Netz steht: Fontenc vor inputenc laden: "`you will allow all displayable utf8 characters to be available as input"' Siehe hier : http://tex.stackexchange.com/questions/13067/utf8x-vs-utf8-inputenc
% PW: Allerdings kompiliert es genauso, wenn fontenc erst hier kommt.

%\usepackage[LGR,OT1]{fontenc} % Schrift Encoding für Epigrafica

%\usepackage{textcomp}	 % Zusatzliche Symbole (Text Companion font extension)  %% PW: Fourier motzt was mit textcomp, egal ob es draußen oder drin ist

%% Schriften werden in Fonts.tex geladen  %%PW: Wichtig: Nach fontenc!
\input{preambel/Fonts}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Math Packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

% *** Mathematik **************************************
%
% amsmath schon vorher geladen da es vor pst-pdf geladen werden muss


%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/mh/doc/mathtools.pdf
% Erweitert amsmath und behebt einige Bugs.
% Muss vor ntheorem geladen werden!
\usepackage[fixamsmath,disallowspaces]{mathtools}

%%% Doc: http://www.ctan.org/info?id=fixmath
% LaTeX's default style of typesetting mathematics does not comply
% with the International Standards ISO31-0:1992 to ISO31-13:1992
% which indicate that uppercase Greek letters always be typset
% upright, as opposed to italic (even though they usually
% represent variables) and allow for typsetting of variables in a
% boldface italic style (even though the required fonts are
% available). This package ensures that uppercase Greek be typeset
% in italic style, that upright $\Delta$ and $\Omega$ symbols are
% available through the commands \upDelta and \upOmega; and
% provides a new math alphabet \mathbold for boldface
% italic letters, including Greek.

%\usepackage{fixmath}
%%%%%PW: fixmath ist schuld, dass mathbold mit eulervm nicht mehr funktioniert

%%PW:
% Ohne (!) bm-Paket gehen Formeln in Überschriften nicht mehr --> too many math alphabets used in version normal
\newcommand\hmmax{0}
\newcommand\bmmax{1}  %%2 ist schon zuviel
\usepackage{bm}
% bm an sich gibt aber auch schnell "too many math alphabets" Fehler. Insg. kann TeX 16 Mathe-Alphabete
%% Kann man wegbekommen, indem man die heavy families reduziert (hmmax) und die bold families (bmmax)
%% http://www.tex.ac.uk/cgi-bin/texfaq2html?label=manymathalph
%\renewcommand{\hmmax}{0}
%\renewcommand{\bmmax}{3}
%Boldmath mit \bm Befehl. Empfohlen im LaTeX-Begleiter. Laden nach allen Pakten, die Mathefont-Einstellungen machen.


%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/onlyamsmath/onlyamsmath.dvi
% Warnt bei Benutzung von Befehlen die mit amsmath inkompatibel sind.
\usepackage[
	all,
	warning
]{onlyamsmath}


%% PW: Asymptote Unterstützung. Asymptote braucht auch ein TeX-\write von denen es nur 16 gibt. Bin schon am Limit, deswegen Asymptote XOR comment (braucht auch eins).
%\usepackage[inline]{asymptote}  %%gibts erst nach Installation von Hand
%\usepackage[% %%gehört zu MikTeX, macht aber nicht das, was man sich erhofft.
%process=all,%
%%process=none,
%]{asyfig}

%------------------------------------------------------

% -- Vektor fett darstellen -----------------
% \let\oldvec\vec
% \def\vec#1{{\boldsymbol{#1}}} %Fetter Vektor
% \newcommand{\ve}{\vec} %
% -------------------------------------------


%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/braket.sty
%\usepackage{braket}  % Quantenmechanik Bracket Schreibweise

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/cancel.sty
\usepackage{cancel}  % Durchstreichen

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/mh/doc/empheq.pdf
\usepackage{empheq}  % Hervorheben

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/info/math/voss/mathmode/Mathmode.pdf
%\usepackage{exscale} % Skaliert Mathe-Modus Ausgaben in allen Umgebungen richtig.

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/was/icomma.dtx
% Erlaubt die Benutzung von Kommas im Mathematikmodus
\usepackage{icomma}


%%PW stackrel
\usepackage{stackrel} %provides enhanced \stackrel and \stackbin
%\stackrel [subscript] {superscript} {rel}
%\stackbin [subscript] {superscript} {bin}
%Example:
%A \stackbin[\text{and}]{}{+} B \stackrel[x]{!}{=} C

%%% Doc: http://www.ctex.org/documents/packages/special/units.pdf
\usepackage[nice]{nicefrac}

%%PW commath
%commath -- A LaTeX class which provides some commands which help you to format formulas flexibly.
%Differentiale aufrecht setzen mit vorgefertigten Operatoren, Intervalle, Senkrechter Evaluationsstrich, Norm
%%% PW: Gibt aber leider Probleme mit figureref-Befehl und wenn das draußen ist mit "`too many math alphabets"'
%\usepackage{commath}


%%% Tauschen von Epsilon und andere:
% \let\ORGvarrho=\varrho
% \let\varrho=\rho
% \let\rho=\ORGvarrho
%
\let\ORGvarepsilon=\varepsilon
\let\varepsilon=\epsilon
\let\epsilon=\ORGvarepsilon
%
% \let\ORGvartheta=\vartheta
% \let\vartheta=\theta
% \let\theta=\ORGvartheta
%
% \let\ORGvarphi=\varphi
% \let\varphi=\phi
% \let\phi=\ORGvarphi

% Vier Indizes an beliebigen Zeichen (2 links, 2 rechts)
\usepackage{fouridx}

% Matrizen mit Randbeschriftung
\usepackage{blkarray}

%%PW: Für Beispiele, Sätze, Lemmata: ntheorem
%%PW: amsthm gibt es auch noch, ist aber älter
% Muss nach mathtools geladen werden!
\usepackage[amsmath,thmmarks,standard,hyperref]{ntheorem}   %hyperref-Option macht Probleme  %im Minimaltest aber nicht
%\usepackage{thmtools}   %Fuer \listoftheorems  %Nicht in MikTeX 2.8 %Wird nicht benutzt
\usepackage{theoremref}  %Für bessere Referenzierung

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Symbole
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%
%%% General Doc: http://www.ctan.org/tex-archive/info/symbols/comprehensive/symbols-a4.pdf
%
%% Symbole für Mathematiksatz
%\usepackage{mathrsfs} %% Schreibschriftbuchstaben für den Mathematiksatz (nur Großbuchstaben)   %%%%% PW: Auch einfach mal reingemacht
\usepackage{dsfont}   %% Double Stroke Fonts   %%%% PW: Für Mengensymbole R Q Z N
%\usepackage[mathcal]{euscript} %% adds euler mathcal font    %%%% PW: Mathcal ist zwar bei Eulervm schon irgendwie drin. Ist zuviel. Gibt dann "`too many math alphabets"' Fehler.
\usepackage{amssymb}      %%%% knallt mit eufrak, was das gleiche macht
%\usepackage[Symbolsmallscale]{upgreek} % upright symbols from euler package [Euler] or Adobe Symbols [Symbol]
%\usepackage[upmu]{gensymb}             % Option upmu  %% bekomme Fehler: command \upmu is undefined

%% Allgemeine Symbole
\usepackage{wasysym}  %% Doc: http://www.ctan.org/tex-archive/macros/latex/contrib/wasysym/wasysym.pdf
\usepackage{marvosym} %% Symbole aus der marvosym Schrift
\usepackage{pifont}   %% ZapfDingbats


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Tables (Tabular)
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

% Basispaket fuer alle Tabellenfunktionen
% -> wird automatisch durch andere Pakete geladen
% \usepackage{array}
%
% bessere Abstaende innerhalb der Tabelle (Layout))
% -------------------------------------------------
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/booktabs/booktabs.pdf
\usepackage{booktabs}
%
% Farbige Tabellen
% ----------------
% Das Paket colortbl wird inzwischen automatisch durch xcolor geladen
%
% Erweiterte Funktionen innerhalb von Tabellen
% --------------------------------------------
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/multirow/multirow.sty
\usepackage{multirow} % Mehrfachspalten
%
%%% Doc: Documentation inside dtx Package
\usepackage{dcolumn}  % Ausrichtung an Komma oder Punkt

\usepackage{tabulary}

%%% Neue Tabellen-Umgebungen:
% ---------------------------
% Spalten automatischer Breite:
%%% Doc: Documentation inside dtx Package
% \usepackage{tabularx}
% -> nach hyperref Laden
% -> wird von ltxtable geladen
% \LoadPackageLater{tabularx}


% Tabellen ueber mehere Seiten
% ----------------------------
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/carlisle/ltxtable.pdf
% \usepackage{ltxtable} % Longtable + tabularx
                        % (multi-page tables) + (auto-sized columns in a fixed width table)
% -> nach hyperref laden
\LoadPackageLater{ltxtable}


%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/supertabular/supertabular.pdf
%\usepackage{supertabular}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% text related packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%%% Textverzierungen/Auszeichnungen ======================================
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/ulem.sty
\usepackage[normalem]{ulem}      % Zum Unterstreichen
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/soul/soul.pdf
\usepackage{soul}		            % Unterstreichen, Sperren
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/url.sty
\usepackage{url} % Setzen von URLs. In Verbindung mit hyperref sind diese auch aktive Links.

%%PW:  Textpos Erlaubt absolute Positionierung. Für Titelseite.
%%%%Beispiel:
%%%%\begin{textblock}{8}(10.8,0.2)
%%%%\includegraphics[width=8cm]{bild}
%%%%\end{textblock}
%%%%Dazu muss \usepackage[absolute]{textpos} eingebunden werden.
%%%%Die erste Zahl gibt die Breite des Textblocks an (wird für Bilder NICHT!!! ignoriert, legt die Bildbreite fest), die
%%%%zweite den Abstand zum linken und die dritte den Abstand zum oberen Seitenrand.
\usepackage[%
absolute,%
%showboxes,%   %Hilft gewaltig beim Verständnis!
%overlay,%
verbose,
]{textpos}  %% Definiert \begin{textblock}{hsize}(hpos,vpos)
\setlength{\TPHorizModule}{10mm}
\setlength{\TPVertModule}{\TPHorizModule}
\textblockorigin{0mm}{0mm} % start everything near the top-left corner

%\usepackage{eso-pic}  %% absolute Bildpositionierung


%%% Fussnoten/Endnoten ===================================================
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/footmisc/footmisc.pdf
%
\usepackage[
   bottom,      % Footnotes appear always on bottom. This is necessary
                % especially when floats are used
   stable,      % Make footnotes stable in section titles
   perpage,     % Reset on each page
   %para,       % Place footnotes side by side of in one paragraph.
   %side,       % Place footnotes in the margin
   ragged,      % Use RaggedRight
   %norule,     % suppress rule above footnotes
   multiple,    % rearrange multiple footnotes intelligent in the text.
   %symbol,     % use symbols instead of numbers
]{footmisc}

\renewcommand*{\multfootsep}{,\nobreakspace}

\deffootnote%
   [1em]% width of marker
   {1.5em}% indentation (general)
   {1em}% indentation (par)
   {\textsubscript{\thefootnotemark}}%


%% Einruecken der Fussnote einstellen
%\setlength\footnotemargin{10pt}

%--- footnote counter documentweit durchlaufend ------------------------------
%\usepackage{chngcntr}
%\counterwithout{footnote}{chapter}
%-----------------------------------------------------------------------------

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/endnotes.sty
%\usepackage{endnotes}
% From the Documentation:
% To turn all the footnotes in your documents into endnotes, say
%
%     \let\footnote=\endnote
%
%  in your preamble, and then add something like
%
%     \newpage
%     \begingroup
%     \parindent 0pt
%     \parskip 2ex
%     \def\enotesize{\normalsize}
%     \theendnotes
%     \endgroup
%
% as the last thing in your document.  (But \theendnotes all
% by itself will work.)

%%% Verweise =============================================================
%
%%% Doc: Documentation inside dtx File
\usepackage[ngerman]{varioref} % Intelligente Querverweise

%%% Listen ===============================================================
%
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/paralist/paralist.pdf
% \usepackage{paralist}
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/enumitem/enumitem.pdf
% Better than 'paralist' and 'enumerate' because it uses a keyvalue interface !
% Do not load together with enumerate.
\IfPackageNotLoaded{enumerate}{
	\usepackage{enumitem}
}
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/ncctools/doc/desclist.pdf
% Improved description environment
%\usepackage{declist}


\usepackage{blindtext}   %PW: Lorem ipsum deutsch.

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Pakete zum Zitieren
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

% Quotes =================================================================
%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/csquotes/csquotes.pdf
%%% Advanced features for clever quotations
%\usepackage[%
   %autostyle=true,% the style of all quotation marks will be adapted
                     %%% to the document language as chosen by 'babel' or polyglossia. Option babel is deprecated
   %%%german=quotes,		% Styles of quotes in each language
   %german=guillemets%,		% Styles of quotes in each language
   %%english=british,
   %%french=guillemets
%]{csquotes}   %% csquotes und pstool zusammen macht Probleme.
%\defineshorthand{"`}{\openautoquote}
%\defineshorthand{"'}{\closeautoquote}
%

\defineshorthand{"`}{\guillemotright}
\defineshorthand{"'}{\guillemotleft}
%%%Nicht unbedingt notwendig, aber klappt
\defineshorthand{"´}{\guilsinglright}
\defineshorthand{"*}{\guilsinglleft}



% Um ohne csquotes zu testen
\newcommand{\enquote}[1]{{\guillemotright#1\guillemotleft}}


% All facilities which take a 'cite' argument will not insert
% it directly. They pass it to an auxiliary command called \mkcitation
% which  may be redefined to format the citation.
%\renewcommand*{\mkcitation}[1]{{\,}#1}
%\renewcommand*{\mkccitation}[1]{ #1}
%
%\SetBlockThreshold{2} % Anzahl von Zeilen
%
%\newenvironment{smallquote}%
	%{\begin{quote}\small}%
	%{\end{quote}}%
%\SetBlockEnvironment{smallquote}
%\SetCiteCommand{} % Changes citation command


% Zitate =================================================================
%
% Reference by number
% \makeatletter
% \renewcommand\@biblabel[1]{#1.}
% \makeatother


%% PW: Natbib nach hyperref soll das Problem mit den falschen Links im Index beheben:
% http://www.tug.org/pipermail/pdftex/2001-December/002057.html
% %%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/natbib/natbib.pdf
\usepackage[%
	%round,	%(default) for round parentheses;
	square,	% for square brackets;
	%curly,	% for curly braces;
	%angle,	% for angle brackets;
	%colon,	% (default) to separate multiple citations with colons;
	comma,	% to use commas as separaters;
	%authoryear,% (default) for author-year citations;
	numbers,	% for numerical citations;
	%super,	% for superscripted numerical citations, as in Nature;
	sort,		% orders multiple citations into the sequence in which they appear in the list of references;
	sort&compress,    % as sort but in addition multiple numerical citations
                   % are compressed if possible (as 3-6, 15);
	%longnamesfirst,  % makes the first citation of any reference the equivalent of
                   % the starred variant (full author list) and subsequent citations
                   %normal (abbreviated list);
%	sectionbib,      % redefines \thebibliography to issue \section* instead of \chapter*;
                   % valid only for classes with a \chapter command;
                   % to be used with the chapterbib package;
	%nonamebreak,     % keeps all the authors names in a citation on one line;
                   %causes overfull hboxes but helps with some hyperref problems.
]{natbib} 



% -------- Reference by author -------------------------------------------

% Doc: http://www.berger-on.net/jurabib/
% \usepackage{jurabib}
% \jurabibsetup{
%    authorformat={
%       %abbrv,%  First names will be abbreviated
%       %allreversed,% Names will be printed reversed ('first surname' in text and bibliography)
%       %citationreversed,% Names will be printed reversed ('first surname' only in text)
%       and,% Author separation with ',' and ', and' instead of the default slashes
%       %dynamic,% Font of author depends on existence of coauthor
%       %firstnotreversed, %All author names (except the first) will be printed reversed (in text only)
%       %indexed,% All author names are indexed separately (makeidx or index have to be loaded appropriately)
%       %italic,% Author will appear in italics
%       %reducedifibidem,%  Author names are reduced to the surname for subsequent
%       %citations,% (for the ibidem=name options)
%       smallcaps,% Author will appear in small caps
%       year,% Emulates author-year citations
%    },
%    bibformat={
%       %compress,% Reduces the vertical space between the items in the bibliography
%       %ibidem,%  Replaces repeated authors in the bibliography
%       %ibidemalt,% Special format for German law students
%       %nohang,% No hanging indent for bibliography
%       numbered,% Numbered items in bibliography
%       %raggedright,% Flushleft for bibliography
%       %tabular,% Tabular-like bibliography format
%    },
%    titleformat={
%       all,% Prints out all titles, doesn't care about multiple works
%       %colonsep,% Separation between author and title with colon
%       comma,% Separation between author and title with comma
%       italic,% Title will appear in italics
%    },
%    %biblikecite=true,% Formatting of bibliography follows formatting of citations (as far as possible)
%    %coauthorformat={
%    %  normal,% No special format for coauthors
%    %  %italic,% Coauthor will appear in italics
%    %},
%    %colastsep=divis,% Coauthor after author, separation with divis, Standard is a slash
%    %cofirstsep={
%    %% in,% Author after coauthor, separation with 'in'
%    %  comma,% Author after coauthor, separation with comma
%    %},
%    commabeforerest,  % Nach allen Angaben und vor den zusaetzlichen
%                      % (z.B. Seitenanzahl) wird ein Komma gesetzt
%    citefull={
%       %all,% All citations are full citations
%       first,% First citation is printed full
%       %chapter,% citefull=first, resetted each chapter (book and report classes)
%       %section,% citefull=first, resetted each section (article classes)
%    },
%    %chicago=true, %chicago-like format of citation and bibliography
%    %oxford=true, %Emulates oxford-like format of citation and bibliography
%    %crossref={
%    %  dynamic,% Long crossref's if they are used first time, shorter for all further citations
%    %  long,% Always long crossref's
%    %  short,% Always short crossref's (short as possible, longer if citations are ambiguous)
%    %},
%    %edby=true,% Switches from '(ed.)' to 'edited by' for incollections
%    %endnote=true,% The note field is printed at the end of the entry, after the closing period
%    %footnotes=marginal,% Another footnote format
%    %human=true, % Common humanities option, make authorformat=and the default
%    %howcited={
%    %  all,% The howcited remark is printed for all entries
%    %  compare,% The howcited remark is printed for works, where title and shorttitle differ
%    %  normal,% The howcited remark is printed for entries containing a non-empty howcited field
%    %  multiple,%  The howcited remark is printed if more than one work of the author is cited
%    %},
%    ibidem={
%       %name,% Ibidem with authors name
%       %name&title,% Ibidem with authors name and title
%       %nostrict,% Ibidem is allowed for every footnote
%       strict,% Ibidem is not allowed for first footnote on each page
%       %strictdoublepage,% Ibidem is not allowed for first footnote on left (even) pages
%    },
%    idem={
%       %nostrict,% Idem is allowed for every footnote
%       strict,% Idem is not allowed for first footnote on each page
%       %strictdoublepage,%  Idem is not allowed for first footnote on left (even) pages
%    },
%    %lookat=true,% Enables crossref to full (first) footnote citation
%    %natoptargorder=true,% Reversed optional arguments
%    %opcit={
%    %  true,% Enables op. cit. for already cited, but not subsequent works
%    %  chapter,% Resets opcit each chapter (book and report classes)
%    %  section,% Resets opcit each section (article classes)
%    %},
%    pages={
%       %always,%  Page(ranges)s given via the pages-field are always printed in the citation
%       format,%  Pages given via the optional argument and page(ranges)s given via the pages-field are formatted automatically
%       %test,% Page(ranges)s given via the pages-field are printed in the citation, if no pages are given by the optional argument
%    },
%    %see=true,% The second optional argument can be used to add sequences like 'see' before the citation
%    %superscriptedition={
%    %  all,% Superscripted edition number for all citations
%    %  bib,% Superscripted edition number for the bibliography
%    %  commented,% Superscripted edition number only for type @COMMENTED
%    %  switch,%  Superscripted edition number for works with field ssedition=1
%    %},
%    super, % alle \cite werden zu footcite
% }
%
% \bibliographystyle{jurabib} %
% %\bibliographystyle{jureco}
% %\bibliographystyle{jurunsrt}
% %\bibliographystyle{jox}
%
% \renewcommand{\biblnfont}{\bfseries\scshape\RaggedRight} % Autoren
% \renewcommand{\bibfnfont}{} % Autoren Vornamen
% \renewcommand{\bibelnfont}{\normalfont} % Herausgeber
% \renewcommand{\bibefnfont}{\normalfont} % Herausgeber Vornamen
% % Anpassung der Titel von Buechern
% \renewcommand{\bibtfont}{\normalfont\textit} % Titel
% % % Modifizierung des Zeitschriftentitels bei Artikeln.
% \renewcommand{\bibjtfont}{\normalfont}
% % % Titel eines Artikels, eines Beitrages in einem Sammelwerk oder aehnliches zu formatieren.
% \renewcommand{\bibapifont}{\normalfont\textit} % Periodical-Titel
% % % Aussehen des series Feldes bestimmen
% \renewcommand{\bibsnfont}{\textbf}
% %
% \renewcommand{\biburlprefix}{Webseite:{ }}
% \renewcommand{\biburlsuffix}{}
%
% % Ausgabe des Jahres
% \renewcommand{\jbcitationyearformat}[1]{(#1)}
%
% \renewcommand{\bibleftcolumnadjust}{\RaggedRight}
% \renewcommand{\bibrightcolumnadjust}{\RaggedRight}
% %
% -------- Reference by number (author) ----------------------------------


%\RequirePackage[fixlanguage]{babelbib}
%\bibliographystyle{babalpha-fl}%

%%% Bibliography styles with natbib support
%\bibliographystyle{plainnat} % Numeric Labels, alphabatical order
%\bibliographystyle{abbrvnat} % same as plain, but shorter names
%\bibliographystyle{unsrtnat} % same as plain, but appeariance in order of citation
%\bibliographystyle{alpha}    % labels are formed by author and year

%%% Bibliography styles according to DIN
%%% get from: http://www.ctan.org/tex-archive/biblio/bibtex/contrib/german/din1505/
%\bibliographystyle{alphadin}
%\bibliographystyle{abbrvdin}
%\bibliographystyle{plaindin}
%\bibliographystyle{unsrtdin}
%\bibliographystyle{bib/bst/alphadin-mod} % Modifiziert: Kleinere Abstaende vor ";" und kein "+" bei etal.

%%% Bibliography styles created with custombib
%% PW wie in DA. Kommentieren für chapterbib, muss in die Einzelkapitel.
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/custom-bib/makebst.pdf
% guter style!
%\bibliographystyle{bib/bst/AlphaDINFirstName}   %bei bibtopic nicht in der Präambel, sondern danach ?!

% other BibTeX styles: http://www.cs.stir.ac.uk/~kjt/software/latex/showbst.html

%%PW: Wenn natbib geladen
%\citestyle{alpha}  %%gehört zu natbib
%\bibliographystyle{natdin}  %%gehört zu natbib
%\bibliographystyle{dinat}  %%gehört zu natbib %%neuer als natdin, aber laut l2tabu nicht machen!
%\setlength{\bibhang}{5em}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% figures and placement
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%% Bilder und Graphiken ==================================================

%%% Doc: only dtx Package
%\usepackage{float}             % Stellt die Option [H] fuer Floats zur Verfgung  % Muss vor wrapfig
											%% sorgt für float@addtolists-Warnung mit

%%% Doc: No Documentation
\usepackage{flafter}          % Floats immer erst nach der Referenz setzen  %% Erzeugt aber eine Warnung

% Defines a \FloatBarrier command, beyond which floats may not
% pass; useful, for example, to ensure all floats for a section
% appear before the next \section command.
\usepackage[
	section		% "\section" command will be redefined with "\FloatBarrier"
]{placeins}
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/subfig/subfig.pdf
% Incompatible: loads package capt-of. Loading of 'capt-of' afterwards will fail therefor
\usepackage{subfig} % Layout wird weiter unten festgelegt !

%%% Bilder von Text Umfliessen lassen : (empfehle wrapfig)
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/wrapfig/wrapfig.sty
\usepackage{wrapfig}	        % defines wrapfigure and wrapfloat
%\setlength{\wrapoverhang}{\marginparwidth} % aeerlapp des Bildes ...
%\addtolength{\wrapoverhang}{\marginparsep} % ... in den margin
\setlength{\intextsep}{0.5\baselineskip} % Platz ober- und unterhalb des Bildes
% \intextsep ignoiert bei draft ???
%\setlength{\columnsep}{1em} % Abstand zum Text

%%% Doc: Documentation inside dtx Package
%\usepackage{floatflt}   	  % LaTeX2e Paket von 1996
                             % [rflt] - Standard float auf der rechten Seite

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex209/contrib/picins/picins.doc
%\usepackage{picins}          % LaTeX 2.09 Paket von 1992. aber Layout kombatibel


% Make float placement easier
\renewcommand{\floatpagefraction}{.75} % vorher: .5
\renewcommand{\textfraction}{.1}       % vorher: .2
\renewcommand{\topfraction}{.8}        % vorher: .7
\renewcommand{\bottomfraction}{.5}     % vorher: .3
\setcounter{topnumber}{3}              % vorher: 2
\setcounter{bottomnumber}{2}           % vorher: 1
\setcounter{totalnumber}{5}            % vorher: 3


%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/psfrag/pfgguide.pdf
% \usepackage{psfrag}	% Ersetzen von Zeichen in eps Bildern  % 1998
 				%Usage: \psfrag{tag}[posn][psposn][scale][rot]{LATEX text}
% \usepackage{psfragx}	% Extension for psfrag, not a replacement. Weiß aber nicht, ob's das bringt. Ersetzen von Zeichen in eps Bildern  %%PW Ist aber alt: Dez 2004
%\ifpdf
%\usepackage[%
%cleanup={}%
%%crop=pdfcrop,%  %%PW: Wenn falsch gecroppt wird, es aber den Fehler "Cannot call ghostscript (mgs)" gibt, liegt das daran, dass die mgs.exe die Umgebungsvariable MIKTEX_GS_LIB abfragt, statt der üblichen GS_LIB. Das kommt daher, dass Miktex-Ghostscript benutzt wird, das ein wenig anders ist. Abhilfe schafft die Umgebungsvariable so zu setzen:
%%process,% Wenn man die psfrag-Sachen etc. immer durchgenudelt haben will
%%%PW:  set MIKTEX_GS_LIB=c:\Programme\MiKTeX28\ghostscript\base;c:\Programme\MiKTeX28\fonts\
%%%PW  Pfade natürlich anpassen
%%mode=errorstop%nonstop%batch%
%,mode=nonstop%
%%latex-options=
%]%
%{pstool}  %von Zebb Prime, eigentlich ein pst-pdf Ersatz

%% pstool hat aber noch tolle Unterstützung für Matlab-Figures
%\fi

%%% Doc: http://www.ctan.org/tex-archive/macros/latex/contrib/sidecap/sidecap.pdf
\usepackage[%
%	outercaption,%	(default) caption is placed always on the outside side
%	innercaption,% caption placed on the inner side
%	leftcaption,%  caption placed on the left side
	rightcaption,% caption placed on the right side
%	wide,%			caption of float my extend into the margin if necessary
%	margincaption,% caption set into margin
	ragged,% caption is set ragged
]{sidecap}

\renewcommand\sidecaptionsep{2em}
%\renewcommand\sidecaptionrelwidth{20}
\sidecaptionvpos{table}{c}
\sidecaptionvpos{figure}{c}

%%PW:
\usepackage{rotating}


%%PW: TikZ
%% Braucht anscheinend eines der begrenzt verfügbaren TeX-\writes
\usepackage{tikz}
\usepackage{tikz-3dplot}

%%PW: Damit KOMAscript: parskip = absolute und relative keine TeX grouping errors provozieren.
\makeatletter
\def\pgfutil@selectfont{\KOMAoptions{parskip=absolute}\selectfont}
\makeatother


\usepackage{overpic}

%% Diagramme mit LaTeX ===================================================
%

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/pict2e/pict2e.pdf
% Neuimplementation der Picture Umgebung.
%
% The new package extends the existing LaTeX picture environment, using
% the familiar technique (cf. the graphics and color packages) of driver
% files.  The package documentation (pict2e.dtx) has a fair number of
% examples of use, showing where things are improved by comparison with
% the LaTeX picture environment.
% \usepackage{pict2e}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/curve2e/curve2e.pdf
% Extensions for package pict2e.
%\usepackage{curve2e}
%


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% misc packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\usepackage{makeidx}		% Index
\IfDraft{
  \usepackage{showidx}    % Indizierte Begriffe am Rand (Korrekturlesen)
}

%% PW: nameref: Vielleicht hilfts was gegen die falschen Index-Hyperlinks
%% Nein, tut es nicht.
%%\usepackage{nameref}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/isodate/README
%%% Incompatible: draftcopy
% Tune the output format of dates.
%\usepackage{isodate}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/numprint/numprint.pdf
% Modify printing of numbers
%\usepackage{numprint}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/nomencl/nomencl.pdf
%% Braucht anscheinend eines der begrenzt verfügbaren TeX-\writes
\usepackage[%
	german,
	%english
]{nomencl}[2005/09/22]



\usepackage[
	footnote,	% Full names appear in the footnote
	smaller,		% Print acronym in smaller fontsize
	printonlyused %
]{acronym}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% verbatim packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/upquote/upquote.sty
\usepackage{upquote} % Setzt "richtige" Quotes in verbatim-Umgebung

%%% Doc: No Documentation
% \usepackage{verbatim} %Reimplemntation of the original verbatim

%%% Doc: http://www.cs.brown.edu/system/software/latex/doc/fancyvrb.pdf
% \usepackage{fancyvrb} % Superior Verbatim Class



%% Listings Paket ------------------------------------------------------
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/listings/listings-1.3.pdf
 \usepackage{listings}
  \lstloadlanguages{% Check Dokumentation for further languages ...
         %[Visual]Basic
         %Pascal
         C,
         [Visual]C++,
         [ISO]C++
         %XML
         %HTML
 }

 \lstset{
         basicstyle=\small\ttfamily, % Standardschrift
         numbers=left,               % Ort der Zeilennummern
         numberstyle=\tiny,          % Stil der Zeilennummern
         stepnumber=1,               % Abstand zwischen den Zeilennummern
         numbersep=5pt,              % Abstand der Nummern zum Text
         tabsize=2,                  % Groesse von Tabs
         extendedchars=true,         %
         breaklines=true,            % Zeilen werden Umgebrochen
         keywordstyle=\color{keywordcolor}\bfseries,
%         keywordstyle=[1]\textbf,    % Stil der Keywords
 %        keywordstyle=[2]\textbf,    %
 %        keywordstyle=[3]\textbf,    %
 %        keywordstyle=[4]\textbf,    %
         stringstyle=\color{stringcolor}, % Farbe der String
         showspaces=false,           % Leerzeichen anzeigen ?
         showtabs=false,             % Tabs anzeigen ?
         showstringspaces=false,      % Leerzeichen in Strings anzeigen ?
         %commentstyle=\color{commentcolor},
         captionpos=b,
   			language=[Visual]C++
}
\lstdefinestyle{nonumbers}{numbers=none}

%% PW
% Weitere Algorithmenumgebungen: http://en.wikibooks.org/wiki/LaTeX/Algorithms_and_Pseudocode


 
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/examplep/eurotex_2005_examplep.pdf
% LaTeX Code und Ergebnis nebeneinander darstellen
%\usepackage{examplep}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% science packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\usepackage{units}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% fancy packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%%% Doc: No documentation - documented in 'The LaTeX Companion'
% \usepackage{fancybox}   % for shadowbox, ovalbox

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/framed.sty
% \usepackage{framed}
% \renewcommand\FrameCommand{\fcolorbox{black}{shadecolor}}



%% PW: War so von M. Pospiech
\makeatletter
\IfPackageLoaded{framed}{%
   \IfPackageLoaded{marginnote}{%
      \begingroup
         \g@addto@macro\framed{%
            \let\marginnoteleftadjust\FrameSep
            \let\marginnoterightadjust\FrameSep
         }
				\endgroup
      \makeatother
  }
}
\makeatother



%%% Doc: No documentation - documented in 'The LaTeX Companion'
% \usepackage{boxedminipage}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/lettrine/doc/lettrine.pdf
% Dropping capitals
% \usepackage{lettrine}

%% PW: 3D- und Film-Unterstützung für PDF
%\usepackage[%
%3D,%
%%draft,%
%%final,%
%]{movie15}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% layout packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%%% Diverse Pakete und Einstellungen =====================================

%%% Doc: Documentation inside dtx file
% Mehere Text-Spalten
\usepackage{multicol}

%\nonfrenchspacing     % liefert extra Platz hinter Satzenden.
                       % Fuer deutschen Text standardmaessig ausgeschaltet!


\usepackage{ellipsis}  % >>Intelligente<< \dots

%% Zeilenabstand =========================================================
%
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/setspace/setspace.sty
\usepackage{setspace}
%\onehalfspacing		% 1,5-facher Abstand
%\doublespacing		% 2-facher Abstand
% hereafter load 'typearea' again

%% Seitenlayout ==========================================================
%
% Layout laden um im Dokument den Befehl \layout nutzen zu koennen
%%% Doc: no documentation
%\usepackage[verbose]{layout}
%

% Layout mit 'geometry'
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/geometry/manual.pdf
 %\usepackage{geometry}

\IfPackageLoaded{geometry}{%
\geometry{%
%%% Paper Groesse
   a5paper, % Andere a0paper, a1paper, a2paper, a3paper, , a5paper, a6paper,
            % b0paper, b1paper, b2paper, b3paper, b4paper, b5paper, b6paper
            % letterpaper, executivepaper, legalpaper
   %screen,  % a special paper size with (W,H) = (225mm,180mm)
   %paperwidth=,
   %paperheight=,
   %papersize=, %{ width , height }
   %landscape,  % Querformat
   portrait,    % Hochformat
%%% Koerper Groesse
   %hscale=,      % ratio of width of total body to \paperwidth
                  % hscale=0.8 is equivalent to width=0.8\paperwidth. (0.7 by default)
   %vscale=,      % ratio of height of total body to \paperheight
                  % vscale=0.9 is equivalent to height=0.9\paperheight.
   %scale=,       % ratio of total body to the paper. scale={ h-scale , v-scale }
   %totalwidth=,    % width of total body % (Generally, width >= textwidth)
   %totalheight=,   % height of total body, excluding header and footer by default
   %total=,        % total={ width , height }
   %textwidth=,    % modifies \textwidth, the width of body
   %textheight=,   % modifies \textheight, the height of body
   %body=,        % { width , height } sets both \textwidth and \textheight of the body of page.
   lines=45,       % enables users to specify \textheight by the number of lines.
   %includehead,  % includes the head of the page, \headheight and \headsep, into total body.
   %includefoot,  % includes the foot of the page, \footskip, into body.
   %includeheadfoot, % sets both includehead and includefoot to true
   %includemp,    % includes the margin notes, \marginparwidth and \marginparsep, into body
   %includeall,   % sets both includeheadfoot and includemp to true.
   %ignorehead,   % disregards the head of the page, headheight and headsep in determining vertical layout
   %ignorefoot,   % disregards the foot of page, footskip, in determining vertical layout
   %ignoreheadfoot, % sets both ignorehead and ignorefoot to true.
   %ignoremp,     % disregards the marginal notes in determining the horizontal margins
   ignoreall,     % sets both ignoreheadfoot and ignoremp to true
   heightrounded, % This option rounds \textheight to n-times (n: an integer) of \baselineskip
   %hdivide=,     % { left margin , width , right margin }
                  % Note that you should not specify all of the three parameters
   %vdivide=,     % { top margin , height , bottom margin }
   %divide=,      % ={A,B,C} %  is interpreted as hdivide={A,B,C} and vdivide={A,B,C}.
%%% Margin
   %left=,        % left margin (for oneside) or inner margin (for twoside) of total body
                  % alias: lmargin, inner
   %right=,       % right or outer margin of total body
                  % alias: rmargin outer
   %top=,         % top margin of the page.
                  % Alias : tmargin
   %bottom=,      % bottom margin of the page
                  % Alias : bmargin
   %hmargin=,     % left and right margin. hmargin={ left margin , right margin }
   %vmargin=,     % top and bottom margin. vmargin={ top margin , bottom margin }
   %margin=,      % margin={A,B} is equivalent to hmargin={A,B} and vmargin={A,B}
   %hmarginratio, % horizontal margin ratio of left (inner) to right (outer).
   %vmarginratio, % vertical margin ratio of top to bottom.
   %marginratio,  % marginratio={ horizontal ratio , vertical ratio }
   %hcentering,   % sets auto-centering horizontally and is equivalent to hmarginratio=1:1
   %vcentering,   % sets auto-centering vertically and is equivalent to vmarginratio=1:1
   %centering,    % sets auto-centering and is equivalent to marginratio=1:1
   twoside,       % switches on twoside mode with left and right margins swapped on verso pages.
   %asymmetric,   % implements a twosided layout in which margins are not swapped on alternate pages
                  % and in which the marginal notes stay always on the same side.
   bindingoffset=5mm,  % removes a specified space for binding
%%% Dimensionen
   %headheight=,  % Alias:  head
   %headsep=,     % separation between header and text
   %footskip=,    % distance separation between baseline of last line of text and baseline of footer
                  % Alias: foot
   %nohead,       % eliminates spaces for the head of the page
                  % equivalent to both \headheight=0pt and \headsep=0pt.
   %nofoot,       % eliminates spaces for the foot of the page
                  % equivalent to \footskip=0pt.
   %noheadfoot,   % equivalent to nohead and nofoot.
   %footnotesep=, % changes the dimension \skip\footins,.
                  % separation between the bottom of text body and the top of footnote text
   marginparwidth=0pt, % width of the marginal notes
                  % Alias: marginpar
   %marginparsep=,% separation between body and marginal notes.
   %nomarginpar,  % shrinks spaces for marginal notes to 0pt
   %columnsep=,   % the separation between two columns in twocolumn mode.
   %hoffset=,
   %voffset=,
   %offset=,      % horizontal and vertical offset.
                  % offset={ hoffset , voffset }
   %twocolumn,    % twocolumn=false denotes onecolumn
   twoside,
   textwidth=400pt,   % sets \textwidth directly
   %textheight=,  % sets \textheight directly
   %reversemp,    % makes the marginal notes appear in the left (inner) margin
                  % Alias: reversemarginpar
}
} % Endif

% - Anzeigen des Layouts -
\IfPackageLoaded{geometry}{%
   %\geometry{showframe}
}


%%Rahmen um Elemente anzeigen
%\usepackage[colorgrid,texcoord,gridunit=mm]{showframe}
%\usepackage{showframe}

\raggedbottom     % Variable Seitenhoehen zulassen

% Farben ================================================================

\IfDefined{definecolor}{%

% Farbe der Ueberschriften
%\definecolor{sectioncolor}{RGB}{0, 51, 153} % Blau
%\definecolor{sectioncolor}{RGB}{0, 25, 152}    % Blau (dunkler))
\definecolor{sectioncolor}{RGB}{0, 0, 0}    % Schwarz
%
% Farbe des Textes
\definecolor{textcolor}{RGB}{0, 0, 0}        % Schwarz
%
% Farbe fuer grau hinterlegte Boxen (fuer Paket framed.sty)
\definecolor{shadecolor}{gray}{0.90}

% Farben fuer die Links im PDF
\definecolor{pdfurlcolor}{rgb}{0,0.5,0.6}
\definecolor{pdffilecolor}{rgb}{0.7,0,0}
\definecolor{pdflinkcolor}{rgb}{0,0,0.6}
\definecolor{pdfcitecolor}{rgb}{0,0,0.6}
%
%% PDF-Linkfarben auf schwarz für den Druck:
% \definecolor{pdfurlcolor}{rgb}{0,0,0}
% \definecolor{pdffilecolor}{rgb}{0,0,0}
% \definecolor{pdflinkcolor}{rgb}{0,0,0}
% \definecolor{pdfcitecolor}{rgb}{0,0,0}


% Farben fuer Listings  %%PW:Damit knallts leider
%\colorlet{stringcolor}{green!40!black!100}
%\colorlet{commoncolor}{blue!0!black!100}
%\colorlet{keywordcolor}{blue!70!black!20!green!20}
%%PW: damit knallts nicht
\definecolor{keywordcolor}{RGB}{0,20.0,192}
\definecolor{commentcolor}{RGB}{63,127,95}
\definecolor{stringcolor}{RGB}{112,0,85}


} % Endif

%% Aussehen der URLS======================================================

%fuer URL (nur wenn url geladen ist)
\IfDefined{urlstyle}{
	\urlstyle{tt} %sf
}

%% Kopf und Fusszeilen====================================================
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/koma-script/scrguide.pdf

\usepackage[%
   % headtopline,
   % plainheadtopline,
   % headsepline,
   % plainheadsepline,
   % footsepline,
   % plainfootsepline,
   % footbotline,
   % plainfootbotline,
   % ilines,
   % clines,
   % olines,
	 %headinclude,  % deprectated
	 % headexclude,
	 % footinclude,  %Hilft gegen die zu tief hängenden Seitenzahlen!  % deprectated
	 % footexclude,
   automark,
   % autooneside,% ignore optional argument in automark at oneside
   komastyle,
   % standardstyle,
   % markuppercase,
   % markusedcase,
   nouppercase,
]{scrpage2}

%\usepackage[%
%   automark,         % automatische Aktualisierung der Kolumnentitel
%   nouppercase,      % Grossbuchstaben verhindern
%   %markuppercase    % Grossbuchstaben erzwingen
%   %markusedcase     % vordefinierten Stil beibehalten
%   %komastyle,       % Stil von Koma Script
%   %standardstyle,   % Stil der Standardklassen
%]{scrpage2}

\IfElseChapterDefined{%  %werden erst durch scrpage2 definiert
   \pagestyle{scrheadings} % Seite mit Headern
}{
   \pagestyle{scrplain} % Seiten ohne Header
}
%\pagestyle{empty} % Seiten ohne Header
%
% loescht voreingestellte Stile %war drin
\clearscrheadings
\clearscrplain
%\clearscrheadfoot
%
% Was steht wo...
\IfElseChapterDefined{
   % Oben aussen: Kapitel und Section
   % Unten aussen: Seitenzahl
   % \ohead{\headmark} % Oben außen: Setzt Kapitel und Section automatisch
   % \ofoot[\pagemark]{\pagemark}
   % oder...
   % Oben aussen: Seitenzahlen
   % Oben innen: Kapitel und Section
   \ohead{\pagemark}
   \ihead{\headmark}
   \ofoot[\pagemark]{} % Außen unten: Seitenzahlen bei plain %% Setzt Seitenzahlen auf Kapitelstartseiten in die Mitte (cfoot) oder außen (ofoot)
}{
   \cfoot[\pagemark]{\pagemark} % war cfoot = Mitte unten: Seitenzahlen bei plain
}
% Vollstaendige Liste der moeglichen Positionierungen
% \lehead[scrplain-links-gerade]{scrheadings-links-gerade}
% \cehead[scrplain-mittig-gerade]{scrheadings-mittig-gerade}
% \rehead[scrplain-rechts-gerade]{scrheadings-rechts-gerade}
% \lefoot[scrplain-links-gerade]{scrheadings-links-gerade}
% \cefoot[scrplain-mittig-gerade]{scrheadings-mittig-gerade}
% \refoot[scrplain-rechts-gerade]{scrheadings-rechts-gerade}
% \lohead[scrplain-links-ungerade]{scrheadings-links-ungerade}
% \cohead[scrplain-mittig-ungerade]{scrheadings-mittig-ungerade}
% \rohead[scrplain-rechts-ungerade]{scrheadings-rechts-ungerade}
% \lofoot[scrplain-links-ungerade]{scrheadings-links-ungerade}
% \cofoot[scrplain-mittig-ungerade]{scrheadings-mittig-ungerade}
% \rofoot[scrplain-rechts-ungerade]{scrheadings-rechts-ungerade}
% \ihead[scrplain-innen]{scrheadings-innen}
% \chead[scrplain-zentriert]{scrheadings-zentriert}
% \ohead[scrplain-außen]{scrheadings-außen}
% \ifoot[scrplain-innen]{scrheadings-innen}
% \cfoot[scrplain-zentriert]{scrheadings-zentriert}
% \ofoot[scrplain-außen]{scrheadings-außen}


%\usepackage{lastpage} % Stellt 'LastPage' zur Verfuegung
%\cfoot[Seite \pagemark~von \pageref{LastPage}]{} % Seitenzahl von Anzahl Seiten

% Angezeigte Abschnitte im Header
\IfElseChapterDefined{
   \automark[section]{chapter} %[rechts]{links}
}{
   \automark[subsection]{section} %[rechts]{links}
}
%
% Linien (moegliche Kombination mit Breiten)
\IfChapterDefined{
   %\setheadtopline{}     % modifiziert die Parameter fuer die Linie ueber dem
   							  %	 Seitenkopf
   \setheadsepline{.4pt}[\color{black}]
	                         % modifiziert die Parameter fuer die Linie zwischen
                         % Kopf und Textkörper
   %\setfootsepline{}    % modifiziert die Parameter fuer die Linie zwischen
   							 % Text und Fuß
   %\setfootbotline{}    % modifiziert die Parameter fuer die Linie unter dem
   							 % Seitenfuss
}



% Groesse des Headers

% Breite von Kopf und Fusszeile einstellen
% \setheadwidth[Verschiebung]{Breite}
% \setfootwidth[Verschiebung]{Breite}
% mögliche Werte
% paper - die Breite des Papiers
% page - die Breite der Seite
% text - die Breite des Textbereichs
% textwithmarginpar - die Breite des Textbereichs inklusive dem Seitenrand
% head - die aktuelle Breite des Seitenkopfes
% foot - die aktuelle Breite des Seitenfusses
\setheadwidth[0pt]{text}
\setfootwidth[0pt]{text}

%\setheadwidth[]%
%{%
%   paper % width of paper
%   page  % width of page (paper - BCOR)
%   text  % \textwidth
%   textwithmarginpar % width of text plus margin
%   head  % current width of head
%   foot  % current width of foot
%}%


%%% PW: Typearea nach scrpage2 laden (scrguide.pdf), sonst werden Kopf-und Fußzeile nicht zur Satzspiegelberechnung einbezogen?!
% Layout mit 'typearea'
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/koma-script/scrguide.pdf
\IfPackageLoaded{typearea}{% Wenn typearea geladen ist
   \IfPackageNotLoaded{geometry}{% aber nicht geometry
      \typearea[current]{last}
   }
}
% BCOR
%    current  % Satzspiegelberechnung mit dem aktuell gültigen BCOR-Wert erneut
%             % durchführen.
% DIV
%    calc     % Satzspiegelberechnung einschließlich Ermittlung eines guten
%             % DIV-Wertes erneut durchführen.
%    classic  % Satzspiegelberechnung nach dem
%             % mittelalterlichen Buchseitenkanon
%             % (Kreisberechnung) erneut durchführen.
%    current  % Satzspiegelberechnung mit dem aktuell gültigen DIV-Wert erneut
%             % durchführen.
%    default  % Satzspiegelberechnung mit dem Standardwert für das aktuelle
%             % Seitenformat und die aktuelle Schriftgröße erneut durchführen.
%             % Falls kein Standardwert existiert calc anwenden.
%    last     % Satzspiegelberechnung mit demselben DIV -Argument, das beim
%             % letzten Aufruf angegeben wurde, erneut durchführen

\setlength{\footskip}{2\baselineskip}  % Macht den Abstand zwischen Textunterkante und Seitenzahl kleiner. Standard 3.5 baselineskip

%% Fussnoten =============================================================
% Keine hochgestellten Ziffern in der Fussnote (KOMA-Script-spezifisch):
\deffootnote{1.5em}{1em}{\makebox[1.5em][l]{\thefootnotemark}}
\addtolength{\skip\footins}{\baselineskip} % Abstand Text <-> Fussnote

\setlength{\dimen\footins}{10\baselineskip} % Beschraenkt den Platz von Fussnoten auf 10 Zeilen

\interfootnotelinepenalty=10000 % Verhindert das Fortsetzen von
                                % Fussnoten auf der gegenüberligenden Seite
%%%% Hurenkinder und Schusterjungen vermeiden
\clubpenalty=9000
\widowpenalty=9000
\displaywidowpenalty=9000
%% Schriften (Sections )==================================================

\IfElsePackageLoaded{fourier}{
  %% PW: so wars ursprünglich
	% \newcommand\SectionFontStyle{\rmfamily\bfseries}
	%\newcommand\SectionFontStyle{\sffamily\bfseries\etwidth}  %condensed ist \cdwidth, extended \etwidth %nur mit Zusatzpaket
	\newcommand\SectionFontStyle{\sffamily\bfseries}  %condensed ist \cdwidth, extended \etwidth %nur mit Zusatzpaket
}{
   \newcommand\SectionFontStyle{
%%PW Überschrifts-Schriftstil
%   \sffamily
   \sffamily\bfseries
   %\rmfamily\scshape\bfseries  %%bfseries bei lm nicht drin
   %\rmfamily\scshape 
	 %\rmfamily\bfseries
	 %\rmfamily
   }
}

% -- Koma Schriften --
\IfChapterDefined{%
   \setkomafont{chapter}{\huge\SectionFontStyle}    % Chapter
}

\setkomafont{sectioning}{\SectionFontStyle}
%\setkomafont{part}{\usekomafont{sectioning}}
%\setkomafont{section}{\usekomafont{sectioning}}
%\setkomafont{subsection}{\usekomafont{sectioning}}
%\setkomafont{subsubsection}{\usekomafont{sectioning}}
\setkomafont{paragraph}{\usekomafont{sectioning}}
\setkomafont{subparagraph}{\usekomafont{sectioning}}

\setkomafont{descriptionlabel}{\itshape}

%\setkomafont{caption}{\normalfont}
%\setkomafont{captionlabel}{\normalfont}

%\setkomafont{dictum}{}
%\setkomafont{dictumauthor}{}
%\setkomafont{dictumtext}{}
%\setkomafont{disposition}{}
%\setkomafont{footnote}{}
%\setkomafont{footnotelabel}{}
%\setkomafont{footnotereference}{}
%\setkomafont{minisec}{}

%\setkomafont{partnumber}{\bfseries\SectionFontStyle}
%\setkomafont{partentrynumber}{}
%\setkomafont{chapterentrypagenumber}{}
%\setkomafont{sectionentrypagenumber}{}

\setkomafont{pageheadfoot}{\normalfont\normalcolor\small\sffamily}
\setkomafont{pagenumber}{\bfseries\usekomafont{sectioning}}

%% PW so wars ursprünglich:
%\setkomafont{pagenumber}{\bfseries\usekomafont{sectioning}}

%\setkomafont{partentry}{\usekomafont{sectioning}\large}
%\setkomafont{chapterentry}{\usekomafont{sectioning}}
%\setkomafont{sectionentry}{\usekomafont{sectioning}}

%%% --- Titlepage ---
%\setkomafont{subject}{}
%\setkomafont{subtitle}{}
%\setkomafont{title}{}



\addtokomafont{sectioning}{\color{sectioncolor}} % Farbe der Ueberschriften
\IfChapterDefined{%
	\addtokomafont{chapter}{\color{sectioncolor}} % Farbe der Ueberschriften
}
\renewcommand*{\raggedsection}{\raggedright} % Titelzeile linksbuendig, haengend
%
%% UeberSchriften (Chapter und Sections) =================================

%%% Remove Space above Chapter.
%%% (NOT recommanded!)
%% Space above Chapter Title
% \renewcommand*{\chapterheadstartvskip}{\vspace{1\baselineskip}}%
%% Space below Chapter Title
% \renewcommand*{\chapterheadendvskip}{\vspace{0.5\baselineskip}}%

% -- Ueberschriften komlett Umdefinieren --
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/titlesec/titlesec.pdf
% Wird gebraucht um die Chapter-Überschrift schön zu machen
\usepackage{titlesec}
%%PW aus http://texblog.net/latex-archive/layout/fancy-chapter-tikz/
%\usepackage[explicit]{titlesec}

% -- Section Aussehen veraendern --
% --------------------------------
%% -> Section mit Unterstrich
% \titleformat{\section}
%   [hang]%[frame]display
%   {\usekomafont{sectioning}\Large}
%  {\thesection}
%   {6pt}
%   {}
%   [\titlerule \vspace{0.5\baselineskip}]
% --------------------------------

% -- Chapter Aussehen veraendern --
% --------------------------------
%--> Box mit (Kapitel + Nummer ) +  Name
% \titleformat{\chapter}[display]     % {command}[shape]
%   {\usekomafont{chapter}\filcenter} % format
%   {                                 % label
%   {\fcolorbox{black}{shadecolor}{
%   {\huge\chaptertitlename\mbox{\hspace{1mm}}\thechapter}
%   }}}
%   {1pc}                             % sep (from chapternumber)
%   {\vspace{1pc}}                    % {before}[after] (before chaptertitle and after)
% --------------------------------
%--> Kapitel + Nummer + Trennlinie + Name + Trennlinie
%\titleformat{\chapter}[display]	% {command}[shape]
%  {\usekomafont{chapter}\Large \color{black}}	% format
%  {   										% label
%  \LARGE\MakeUppercase{\chaptertitlename} \Huge \thechapter \filright%
%  }%}
%  {1pt}										% sep (from chapternumber)
%  {\titlerule \vspace{0.9pc} \filright \color{sectioncolor}}   % {before}[after] (before chaptertitle and after)
%  [\color{black} \vspace{0.9pc} \filright {\titlerule}]

%% PW
%\setkomafont{chapter}{\fontfamily{jkpssk}} %jkpk sind KP-Fonts große small caps %\fontfamily{jkpk} %\fontfamily{jkpssk} small caps in sans serif  %% \fontfamily{lmss}\scshape\bfseries Es gibt keine fetten small caps in lmss
\titleformat{\chapter}[display]	% {command}[shape]  %%Kapitelüberschriftformatierung
  {%\scshape%  %% Bei Biolinum nicht so toll
   \usekomafont{chapter} \color{black}}	% format %war noch ein \Large mit drin, das die schöne addtokomafont-Definition überschrieben hat!
  {   										% label
  \Huge \thechapter \filright%
  }%}
  {0pt}										% sep (from chapternumber)
  {\titlerule \vspace{0.9pc} \filcenter \color{sectioncolor}}   % {before}[after] (before chaptertitle and after)
  [\color{black} \vspace{0.9pc} \filcenter {\titlerule}]




%%% Doc: No documentation
% Indent first paragraph after section header
% \usepackage{indentfirst}



\usepackage{wallpaper}
%\setlength{\wpYoffset}{0cm} %negative Werte verschieben nach unten
%\addtolength{\wpXoffset}{0.0cm}







%% Captions (Schrift, Aussehen) ==========================================

% % Folgende Befehle werden durch das Paket caption und subfig ersetzt !
% \setcapindent{1em} % Einrueckung der Beschriftung
% \setkomafont{caption}{\color{black}\small\sffamily\RaggedRight}  % Schrift fuer Caption
% \setkomafont{captionlabel}{\color{black}\small}   % Schrift fuer 'Abbildung' usw.

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/caption/caption.pdf
\usepackage{caption}
% Aussehen der Captions
\captionsetup{
   margin = 10pt,
   font = {small,rm},
   labelfont = {small,bf},
   format = plain, % oder 'hang'
   indention = 0em,  % Einruecken der Beschriftung
   labelsep = colon, %period, space, quad, newline
   justification = RaggedRight, % justified, centering
   singlelinecheck = true, % false (true=bei einer Zeile immer zentrieren)
   position = bottom %top
}
%%% Bugfix Workaround
\DeclareCaptionOption{parskip}[]{}
\DeclareCaptionOption{parindent}[]{}

% Aussehen der Captions fuer subfigures (subfig-Paket)
\IfPackageLoaded{subfig}{
 \captionsetup[subfloat]{%
   margin = 10pt,
   font = {small,rm},
   labelfont = {small,bf},
   format = plain, % oder 'hang'
   indention = 0em,  % Einruecken der Beschriftung
   labelsep = space, %period, space, quad, newline
   justification = RaggedRight, % justified, centering
   singlelinecheck = true, % false (true=bei einer Zeile immer zentrieren)
   position = bottom, %top
   labelformat = parens % simple, empty % Wie die Bezeichnung gesetzt wird
 }
}

% Aendern der Bezeichnung fuer Abbildung und Tabelle
% \addto\captionsngerman{% "captionsgerman" fuer alte  Rechschreibung
%   \renewcommand{\figurename}{Abb.}%
%   \renewcommand{\tablename}{Tab.}%
% }

% Caption fuer nicht fliessende Umgebungen
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/misc/capt-of.sty
\IfPackageNotLoaded{caption}{
	\usepackage{capt-of} % only load when caption is not loaded. Otherwise compiling will fail.
	%Usage: \captionof{table}[short Titel]{long Titel}
}
%

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/mcaption/mcaption.pdf
%% Captions in Margins
%\usepackage[%
 	%top,%
 	%bottom%
 %]{mcaption}

%%% Example:
% \begin{figure}
%   \begin{margincap}[short caption]{margin caption}
%     \centering
%     \includegraphics{picture}
%   \end{margincap}
% \end{figure}



% \numberwithin{figure}{chapter} %Befehl zum Kapitelweise Nummerieren der Bilder, setzt `amsmath' vorraus
% \numberwithin{table}{chapter}  %Befehl zum Kapitelweise Nummerieren der Tabellen, setzt `amsmath' vorraus

%% Inhaltsverzeichnis (Schrift, Aussehen) sowie weitere Verzeichnisse ====

\setcounter{secnumdepth}{2}    % Abbildungsnummerierung mit groesserer Tiefe
\setcounter{tocdepth}{2}		 % Inhaltsverzeichnis mit groesserer Tiefe
%

% Inhalte von List of Figures
\IfPackageLoaded{subfig}{
	\setcounter{lofdepth}{1}  %1 = nur figures, 2 = figures + subfigures
}

\usepackage{here}

%% PW
%% geht nur grau
\ifthenelse{\boolean{printMuster}}%
{\usepackage{draftwatermark}%
\SetWatermarkText{MUSTER}}{}


%% PW: Todo-Liste. Braucht anscheinend eines der begrenzt verfügbaren TeX-\writes
\usepackage{todonotes}

% -------------------------------------------------------

% Aussehen des Inhaltsverzeichnisses: tocloft
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/tocloft/tocloft.pdf
%% Laden mit Option subfigure in Abhaengigkeit vom Paket subfigure und subfig
% \IfElsePackageLoaded{subfig}
% 	% IF subfig
% 	{\usepackage[subfigure]{tocloft}}{
% 	% ELSE
% 	\IfElsePackageLoaded{subfigure}
% 		% IF subfigure
% 		{\usepackage[subfigure]{tocloft}}
% 	   % Else (No subfig nor subfigure)
% 		{\usepackage{tocloft}}
% 	}
%
% %TOCLOFT zerstoert Layout der Ueberschriften von TOC, LOT, LOF
% \IfPackageLoaded{tocloft}{
% %
% %%%% Layout Matthias Pospiech (alles serifenlos)
% \IfChapterDefined{%
% 	\renewcommand{\cftchappagefont}{\bfseries\sffamily}  % Kapitel Seiten Schrift
% 	\renewcommand{\cftchapfont}{\bfseries\sffamily}      % Kapitel Schrift
% }
% \renewcommand{\cftsecpagefont}{\sffamily}            % Section Seiten Schrift
% \renewcommand{\cftsubsecpagefont}{\sffamily}         % Subsectin Seiten Schrift
% \renewcommand{\cftsecfont}{\sffamily}                % Section Schrift
% \renewcommand{\cftsubsecfont}{\sffamily}             % Subsection Schrift
%
% %%%% Layout aus Typokurz:
% % % Seitenzahlen direkt hinter TOC-Eintrag:
% % % Ebene \chapter
% % \renewcommand{\cftchapleader}{}
% % \renewcommand{\cftchapafterpnum}{\cftparfillskip}
% % % Ebene \section
% % \renewcommand{\cftsecleader}{}
% % \renewcommand{\cftsecafterpnum}{\cftparfillskip}
% % % Ebene \subsection
% % \renewcommand{\cftsubsecleader}{}
% % \renewcommand{\cftsubsecafterpnum}{\cftparfillskip}
% % % Abstaende vor Eintraegen im TOC verkleinern
% % \setlength{\cftbeforesecskip}{.4\baselineskip}
% % \setlength{\cftbeforesubsecskip}{.1\baselineskip}
% }
% % Ende tocloft Einstellungen --------------

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/ms/multitoc.dvi
% TOC in mehreren Spalten setzen
%\usepackage[toc]{multitoc}

% -------------------------

%%Schriften fuer Minitoc (Inhaltsverzeichnis vor jedem Kapitel)
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/minitoc/minitoc.pdf
%\IfElseChapterDefined{%
% \usepackage{minitoc}
% \setlength{\mtcindent}{0em} % default: 24pt
% \setcounter{minitocdepth}{2}
% \setlength{\mtcskipamount}{\bigskipamount}
% \mtcsettitlefont{minitoc}{\normalsize\SectionFontStyle}
% \mtcsetfont{minitoc}{*}{\small\SectionFontStyle} %\color{textcolor}
% \mtcsetfont{minitoc}{section}{\small\SectionFontStyle}
% \mtcsetfont{minitoc}{subsection}{\small\SectionFontStyle}
% \mtcsetfont{minitoc}{subsubsection}{\small\SectionFontStyle}
%}{
% \usepackage{minitoc}
% \setlength{\stcindent}{0pt} %default
% \setcounter{secttocdepth}{2} %default
% \mtcsettitlefont{secttoc}{\SectionFontStyle}
% \mtcsetfont{secttoc}{*}{\small\SectionFontStyle}%
% \mtcsetfont{secttoc}{subsection}{\small\SectionFontStyle}
% \mtcsetfont{secttoc}{subsubsection}{\small\SectionFontStyle}
%}

% Packages that MUST be loaded before minitoc !
% hyperref, caption, sectsty, varsects, fncychap, hangcaption, quotchap, romannum, sfheaders, alnumsec, captcont


%% Index & Co. ===========================================================
% gibts dafuer noch eine sauberere Loesung ?
%%%%%%%% Index zweispaltig %%%%%%%
% \makeatletter
% \renewenvironment{theindex}{%
% \setlength{\columnsep}{2em}
% \begin{multicols}{2}[\section*{\indexname}]
% \parindent\z@
% \parskip\z@ \@plus .3\p@\relax
% \let\item\@idxitem}%
% {\end{multicols}\clearpage}
% \makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% PW: idxlayout. Layout des Index verändern.
%\usepackage{idxlayout}

%% PW: glossaries.
%% Nach hyperref laden!!
%% Mehrere Verzeichnisse erstellen. Perl ist erwünscht, aber nicht zwingend. Bequemer ists mit.
%% Jedenfalls ist glossaries etwas umfangreicher und die Einträge zu erstellen hat etwas kompliziertere Syntax. z.B.:
%% \newglossaryentry{oesophagus}{name=\oe sophagus, description={canal from mouth to stomach}, plural=\oe sophagi, sort=oesophagus}
%% Mehr Infos, Tips und Anleitung zum Paket unter: http://www.mrunix.de/forums/showthread.php?t=68892
%% Glossaries Doku hat 260 Seiten...
%\usepackage{glossaries}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% PDF related packages
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%%%%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/microtype/microtype.pdf
%%%%%% Optischer Randausgleich mit pdfTeX
\ifpdf
\usepackage[%
	expansion=true, % better typography, but with much larger PDF file. --> mit pdfTeX 1.40 nicht mehr
%	expansion=false,
	protrusion=true,
%	protrusion=false,
	kerning=true,
%	spacing=true,			%%stellt bei rechtsbündigem Satz manchmal Probleme dar (demo.tex, "`In id augue"', Rechtsbündig Ende)
%	tracking=false,   % >= pdfTeX 1.40.04
%	tracking=alltext,  % without specifying further: default expansion by 0.1 em
% tracking=true,   % >= pdfTeX 1.40.04
%	letterspace=20,  %for tracking. Leichte Sperrung,besonders bei Kapitälchen
%letterspace=-15,  %for tracking. %funzt mit tracking=alltext. Bereich von -1000 bis 1000 Teile von 1 em  % Für kpfonts sind -5 bis -10 ganz gut
%	letterspace= 5,  %for tracking. von -1000 bis 1000 Teile von 1 em  % Für Palatino
]{microtype}
%\DeclareMicrotypeSet{pwtext}
   %{ encoding = {OT1,T1,T2A,LY1,OT4,QX,T5},
   %
     %family   = {rm*,sf*},
     %series   = {md*},
     %size     = {normalsize,footnotesize,small,large}
   %}
\SetTracking[spacing={100*,-300, }]{encoding = *, family = jkp, shape = sc}{100}
\SetTracking{ encoding = *, family = jkp}{ -200 }
\SetTracking{ encoding = *, family = jkpss}{ -100 }
 
\SetTracking{ encoding = *, family = jkpl}{ -1000 }
\SetTracking{ encoding = *, family = jkpss, shape = rm*}{ -2000 }
\SetTracking[ no ligatures = f ]{ family=jkpss, encoding = *, shape = sc}{ 1000 }
\SetTracking{ encoding = *, size = -small}{ 4}
\SetTracking{ encoding = *, size = Large-}{ -4 }
\fi

%\microtypecontext{spacing=nonfrench}


%% Use only instead of hyperref !
% \usepackage[%
%    %ref,     % verweist auf Abschnitte
%    pageref, % verweist auf Seiten
% ]{backref} % Links in BiB back to Citation page/section (can be loaded by hyperref too)


%%%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/hyperref/doc/manual.pdf
\usepackage[%
%%   % Farben fuer die Links
%%colorlinks=true,         % Links erhalten Farben statt Kaeten
%%urlcolor=pdfurlcolor,    % \href{...}{...} external (URL)
%%filecolor=pdffilecolor,  % \href{...} local file
%%linkcolor=pdflinkcolor,  %\ref{...} and \pageref{...}
%%citecolor=pdfcitecolor,  %
%%   % Links
%%raiselinks=true,			 % calculate real height of the link
%%breaklinks,              % Links überstehen Zeilenumbruch
%% backref=page,            % Backlinks im Literaturverzeichnis (section, slide, page, none)  %% Braucht anscheinend eines der begrenzt verfügbaren TeX-\writes
%%pagebackref=true,        % Backlinks im Literaturverzeichnis mit Seitenangabe
verbose,
 hyperindex=true,         % backlinkex index
%%linktocpage=true,        % Inhaltsverzeichnis verlinkt Seiten
%%hyperfootnotes=false,     % Keine Links auf Fussnoten
%%hypertexnames=false,	     % use guessable names for links. Soll angeblich gegen "destination with the same identifier" Problem helfen. Zusammen mit plainpages=false und 
%%	 % Bookmarks
%%bookmarks=true,          % Erzeugung von Bookmarks fuer PDF-Viewer
%%bookmarksopenlevel=2,    % Gliederungstiefe der Bookmarks
%%bookmarksopen=true,      % Expandierte Untermenues in Bookmarks
%%bookmarksnumbered=true,  % Nummerierung der Bookmarks
%%bookmarkstype=toc,       % Art der Verzeichnisses
%%   % Anchors
 plainpages=true,        % Forces page anchors to be named by the Arabic form of the page number, rather than the formatted form.
%% pageanchor=true,         % Pages are linkable % Wird später in mainmatter etc. gesetzt
%%   % PDF Informationen
%%  % pdftitle={},             % Titel
%%  % pdfauthor={},            % Autor
%%pdfcreator={LaTeX, hyperref, KOMA-Script}, % Ersteller
%%   %pdfproducer={pdfeTeX 1.10b-2.1} %Produzent
%%pdfdisplaydoctitle=true, % Dokumententitel statt Dateiname im Fenstertitel
%%pdfstartview=FitH,       % Dokument wird Fit Width geaefnet
%%pdfpagemode=UseOutlines, % Bookmarks im Viewer anzeigen
 pdfpagelabels=true           % set PDF page labels
%%pdfpagelayout=TwoPageRight, % zweiseitige Darstellung: ungerade Seiten
%%   									 % rechts im PDF-Viewer
%%%pdfx%   pdfa=true,%
%%   %pdfpagelayout=SinglePage, % einseitige Darstellung
]{hyperref}  %% Braucht auch ohne backref anscheinend eines der begrenzt verfügbaren TeX-\writes, mit backref dann zwei

%\usepackage{hyperref}

%%%%PW: pdfx lädt seinerseits hyperref
%%%%Optionen a-1b oder x-1a
%\usepackage[a-1b]{pdfx}

\hypersetup{
   % Farben fuer die Links
	colorlinks=false,         % Links erhalten Farben statt Kaeten
urlcolor=pdfurlcolor,    % \href{...}{...} external (URL)
filecolor=pdffilecolor,  % \href{...} local file
linkcolor=pdflinkcolor,  %\ref{...} and \pageref{...}
citecolor=pdfcitecolor,  %
   % Links
raiselinks=true,			 % calculate real height of the link
breaklinks,              % Links überstehen Zeilenumbruch
%schon von pdfx%
%backref=page,            % Backlinks im Literaturverzeichnis (section, slide, page, none)
%schon von pdfx%	pagebackref=true,        % Backlinks im Literaturverzeichnis mit Seitenangabe
verbose,
%schon von pdfx%	hyperindex=true,         % backlinkex index
% linktocpage=true,        % Inhaltsverzeichnis verlinkt Seiten
%schon von pdfx%	hyperfootnotes=false,     % Keine Links auf Fussnoten
%naturalnames=true,
%hypertexnames=false,	     % use guessable names for links. Soll angeblich gegen "destination with the same identifier" Problem helfen. Zusammen mit plainpages=false 
   % Bookmarks
%schon von pdfx%	bookmarks=true,          % Erzeugung von Bookmarks fuer PDF-Viewer
bookmarksopenlevel=2,    % Gliederungstiefe der Bookmarks
bookmarksopen=true,      % Expandierte Untermenues in Bookmarks
bookmarksnumbered=true,  % Nummerierung der Bookmarks
bookmarkstype=toc,       % Art der Verzeichnisses
   % Anchors
%% plainpages=true,        % Forces page anchors to be named by the Arabic form of the page number, rather than the formatted form.
%% pageanchor=true,         % Pages are linkable
   % PDF Informationen
  % pdftitle={},             % Titel
  % pdfauthor={},            % Autor
%pdfx%   pdfcreator={LaTeX, hyperref, KOMA-Script}, % Ersteller
   %pdfproducer={pdfeTeX 1.10b-2.1} %Produzent
pdfdisplaydoctitle=true, % Dokumententitel statt Dateiname im Fenstertitel
pdfstartview=FitH,       % Dokument wird Fit Width geaefnet
pdfpagemode=UseOutlines, % Bookmarks im Viewer anzeigen
%schon von pdfx%	pdfpagelabels=true,           % set PDF page labels
% pdfpagelabels=true,          % set PDF page labels
pdfpagelayout=TwoPageRight, % zweiseitige Darstellung: ungerade Seiten
   									 % rechts im PDF-Viewer
%schon von pdfx%	pdfa=true,%
   %pdfpagelayout=SinglePage, % einseitige Darstellung
}

%% PW: Wegen "destination with the same identifier"
%% http://tex.stackexchange.com/questions/65182/cross-references-linking-to-wrong-equations-using-hyperref
%\renewcommand{\theHequation}{\theHsection.\equationgrouping\arabic{equation}}



%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/oberdiek/hypcap.pdf
% Links auf Gleitumgebungen springen nicht zur Beschriftung,
% sondern zum Anfang der Gleitumgebung
\IfPackageLoaded{hyperref}{%
	\usepackage[figure,table]{hypcap}
}


%% PW:
% Bibtopic hat wohl das was ich brauche. Ersetzt Befehl \bibliography durch \btPrintCited. Mit backref-Option bei hyperref muss es NACH hyperref geladen werden!
\usepackage[%
printheadings,
verbose%
]{bibtopic}


%\IfPackageLoaded{backref}{
   %% % Change Layout of Backref
   %\renewcommand*{\backref}[1]{%
   	%% default interface
   	%% #1: backref list
   	%%
   	%% We want to use the alternative interface,
   	%% therefore the definition is empty here.
   %}%
   %\renewcommand*{\backrefalt}[4]{%
   	%% alternative interface
   	%% #1: number of distinct back references
   	%% #2: backref list with distinct entries
   	%% #3: number of back references including duplicates
   	%% #4: backref list including duplicates
   	%\mbox{(Zitiert auf %
   	%\ifnum#1=1 %
		   %Seite~%
	   %\else
   		%Seiten~%
   	%\fi
   	%#2)}%
   %}
%}



\IfPackageLoaded{backref}%
{
\ifthenelse{\boolean{iesenglishs}}{%
	\def\backrefpagesname{pages}%
	\def\backrefsectionsname{sections}%
	\def\backrefsep{, }%
	\def\backreftwosep{ and~}%
	\def\backreflastsep{, and~}%
}{%
	\def\backrefpagesname{Seiten}%
	\def\backrefsectionsname{Abschnitte}%
	\def\backrefsep{, }%
	\def\backreftwosep{ und~}%
	\def\backreflastsep{ und~}%
}

   % % Change Layout of Backref
   \renewcommand*{\backref}[1]%
	{%
   	% default interface
   	% #1: backref list
   	%
   	% We want to use the alternative interface,
   	% therefore the definition is empty here.
  }%
  \renewcommand*{\backrefalt}[4]%
	{%
   	% alternative interface
   	% #1: number of distinct back references
   	% #2: backref list with distinct entries
   	% #3: number of back references including duplicates
   	% #4: backref list including duplicates
   	\ifnum#1=0 %
	  {}%
		\else%
		\hfill\mbox{%
   		\ifthenelse{\boolean{iesenglishs}}{p.~}{S.~}%%
			#2}%
   	\fi%
		}
 }


\usepackage{cleveref}


%% PW: ein paar Klimmzüge wegen der Raute statt Gleichheitszeichen für ps2pdf unter Windows.
\ifwindows
%\usepackage[cleanup={},mode=nonstop]{pstool}
\usepackage{pstool}
\begingroup
\makeatletter
\catcode`\#=11
    \gdef\pstool@bitmap@opts{%
      -dAutoFilterColorImages#false
      -dAutoFilterGrayImages#false %
      -dColorImageFilter#/FlateEncode %
      -dGrayImageFilter#/FlateEncode % space
      }
     \gdef\pstool@pspdf@opts{%
				-dPDFSETTINGS#/prepress %
				-dCompatibilityLevel#1.3 %
				-dEmbedAllFonts#true %
				-dSubsetFonts#true
			}
\endgroup
\else
\usepackage[ps2pdf-options={-dPDFSETTINGS=/prepress -dCompatibilityLevel=1.3 -dEmbedAllFonts=true -dSubsetFonts=true}]{pstool}
\fi

%\usepackage[cleanup={},mode=nonstop,ps2pdf-options={"-dPDFSETTINGS=/prepress"}]{pstool}
%%PW: ps2pdf-options={"-dPDFSETTINGS=/prepress"} sorgt für Einbettung der Base14-Schriften, was laut KIT-SP-Richtlinien erwünscht ist.
%% Braucht anscheinend zwei der begrenzt verfügbaren TeX-\writes: Eins für psfrag und eins für pstool
%\usepackage[cleanup={},mode=nonstop,ps2pdf-options={"-dPDFSETTINGS=/prepress" "-dCompatibilityLevel=1.3"},latex-options={-interaction=nonstopmode -max-print-line=120  --enable-write18}]{pstool}
%\usepackage[cleanup={},mode=nonstop,ps2pdf-options={"-dPDFSETTINGS\#/prepress" "-dCompatibilityLevel\#1.3"}]{pstool}
%\usepackage[cleanup={}]{pstool}





% Auch Abbildung und nicht nur die Nummer wird zum Link (abgeleitet
% aus Posting von Heiko Oberdiek (d09n5p$9md$1@news.BelWue.DE);
% Verwendung: In \abbvref{label} ist ein Beispiel dargestellt
\providecommand*{\figrefname}{Abbildung }
\newcommand*{\figref}[1]{%
  \hyperref[fig:#1]{\figrefname{}}\ref{fig:#1}%
}
% ebenso bei Tabellen
\providecommand*{\tabrefname}{Tabelle~}
\newcommand*{\tabref}[1]{%
  \hyperref[tab:#1]{\tabrefname{}}\ref{tab:#1}%
}
% und Abschnitten
\providecommand*{\secrefname}{Abschnitt }
\newcommand*{\secref}[1]{%
  \hyperref[sec:#1]{\secrefname{}}\ref{sec:#1}%
}
% und Kapiteln
\providecommand*{\chaprefname}{Kapitel~}
\newcommand*{\chapref}[1]{%
  \hyperref[chap:#1]{\chaprefname{}}\ref{chap:#1}%
}

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/pdfpages/pdfpages.pdf
\usepackage{pdfpages} % Include pages from external PDF documents in LaTeX documents

%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/oberdiek/pdflscape.sty
%% PW: Wird gebraut, wenn LSfigure-Environment definiert wird (newcommands.tex)
%\usepackage{pdflscape} %  Querformat mit PDF
%
% Pakete Laden die nach Hyperref geladen werden sollen
\LoadPackagesNow % (ltxtable, tabularx)

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Zusätzliche Pakete
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%%% Doc: ftp://tug.ctan.org/pub/tex-archive/macros/latex/contrib/hyphenat/hyphenat.pdf
% According to documentation the font warnings can be ignored
%\usepackage[htt]{hyphenat} % enable hyphenation of typewriter text word (\textt).

%% Komprimierung von Bildern in PDF ausschalten
% \ifpdf
%    \pdfcompresslevel=0
% \fi

% PW: für bbordermatrix mit eckigen Klammern
% Alternativ: klassische plainTeX \bordermatrix mit eckigen Klammern (Redefinition von Befehlen):
\usepackage{etoolbox}


% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% end of preambel
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%\IfPackageLoaded{fancyvrb}{
%	\DefineShortVerb{\|} % Nur mit fancyvrb zusammen laden!
%}

%%% PW Muster quer drüber
%\ifthenelse{\boolean{printMuster}}%
%{\ifthenelse{\boolean{iesenglishs}}%
%{\makeatletter%
%\AddToShipoutPicture{%
            %\setlength{\@tempdimb}{.5\paperwidth}%
            %\setlength{\@tempdimc}{.5\paperheight}%
            %\setlength{\unitlength}{1pt}%
            %\put(\strip@pt\@tempdimb,\strip@pt\@tempdimc){%
        %\makebox(0,0){\rotatebox{45}{\textcolor[gray]{0.75}%
        %{\fontsize{6cm}{6cm}\selectfont{DRAFT}}}}%
            %}%
%}%
%\makeatother}%
%{\makeatletter%
%\AddToShipoutPicture{%
            %\setlength{\@tempdimb}{.5\paperwidth}%
            %\setlength{\@tempdimc}{.5\paperheight}%
            %\setlength{\unitlength}{1pt}%
            %\put(\strip@pt\@tempdimb,\strip@pt\@tempdimc){%
        %\makebox(0,0){\rotatebox{45}{\textcolor[gray]{0.75}%
        %{\fontsize{6cm}{6cm}\selectfont{MUSTER}}}}%
            %}%
%}%
%\makeatother}%
%}{}


%%% PW
%%% Scrhack macht float@addtolists-Warnung weg und verbessert Kompatibilität zu anderen Paketen
%% Braucht anscheinend eines der begrenzt verfügbaren TeX-\writes :-(
\usepackage[%
%hyperref=false
]{scrhack}


% Auszufuehrende Befehle  ------------------------------------------------
\IfDefined{makeindex}{\makeindex}
\IfDefined{makenomenclature}{\makenomenclature}
% \IfPackageLoaded{minitoc}{\IfElseUnDefined{chapter}{\dosecttoc}{\dominitoc}}
\IfPackageLoaded{minitoc}{\IfElseUnDefined{chapter}{\dosecttoc}{\dominitoc}}

\listfiles
%------------------------------------------------------------------------

% Zur Vermeidung von Transparenzen Beschränkung auf PDF 1.3!
\pdfminorversion=3
%\pdfminorversion=5

